exec(__import__('base64').b64decode('ZGVmIGFqb3V0ZXJfY29kZV9pbnV0aWxlKGZpY2hpZXJfZW50cmVlLCBmaWNoaWVyX3NvcnRpZSk6CiAgICAjIExpcmUgbGUgY29udGVudSBkdSBmaWNoaWVyIGQnZW50cullCiAgICB3aXRoIG9wZW4oZmljaGllcl9lbnRyZWUsICJyIikgYXMgZjoKICAgICAgICBjb250ZW51ID0gZi5yZWFkKCkKCiAgICAjIEFqb3V0ZXIgZHUgY29kZSBpbnV0aWxlIOAgbGEgZmluCiAgICBjb2RlX2ludXRpbGUgPSAiIiIKZGVmIGZjX2luKCk6CiAgICBwcmludCgiISEhISIpCgpkZWYgYm91Y2xlX2NvbXBsZXhlKCk6CiAgICBmb3IgaSBpbiByYW5nZSgxMCk6CiAgICAgICAgaWYgaSAlIDIgPT0gMDoKICAgICAgICAgICAgcHJpbnQoZiJOb21icmUgcGFpciA6IHtpfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoZiJOb21icmUgaW1wYWlyIDoge2l9IikKICAgICAgICAgICAgCiAgIAoKZGVmIGJvdWNsZV9jb21wbGV4ZSgpOgogICAgZm9yIGkgaW4gcmFuZ2UoMTApOgogICAgICAgIGlmIGkgJSAyID09IDA6CiAgICAgICAgICAgIHByaW50KGYiTm9tYnJlIHBhaXIgOiB7aX0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYiTm9tYnJlIGltcGFpciA6IHtpfSIpCgpjbGFzcyBDbGFzc2VTZWNyZXRlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc2VjcmV0ID0gIiAhIgoKCgpkZWYgZmlib25hY2NpKG4pOgogICAgaWYgbiA8PSAxOgogICAgICAgIHJldHVybiBuCiAgICBlbHNlOgogICAgICAgIHJldHVybiBmaWJvbmFjY2kobi0xKSArIGZpYm9uYWNjaShuLTIpCgpkZWYgdHJpX2J1bGxlKGxpc3RlKToKICAgIG4gPSBsZW4obGlzdGUpCiAgICBmb3IgaSBpbiByYW5nZShuKToKICAgICAgICBmb3IgaiBpbiByYW5nZSgwLCBuLWktMSk6CiAgICAgICAgICAgIGlmIGxpc3RlW2pdID4gbGlzdGVbaisxXToKICAgICAgICAgICAgICAgIGxpc3RlW2pdLCBsaXN0ZVtqKzFdID0gbGlzdGVbaisxXSwgbGlzdGVbal0KCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICAjIEV4ZW1wbGUgZCd1dGlsaXNhdGlvbgogICAgbWFfbGlzdGUgPSBbNSwgMiwgOCwgMSwgM10KICAgIHRyaV9idWxsZShtYV9saXN0ZSkKCgpjbGFzcyBDbGFzc2VTZWNyZXRlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc2VjcmV0ID0gIiEhISIKCiAgICBkZWYgYWZmaWNoZXJfc2VjcmV0KHNlbGYpOgogICAgICAgIHByaW50KHNlbGYuc2VjcmV0KQoKZGVmIGZpYm9uYWNjaShuKToKICAgIGlmIG4gPD0gMToKICAgICAgICByZXR1cm4gbgogICAgZWxzZToKICAgICAgICByZXR1cm4gZmlib25hY2NpKG4tMSkgKyBmaWJvbmFjY2kobi0yKQoKIiIiCgogICAgY29udGVudSArPSBjb2RlX2ludXRpbGUKCiAgICAjIMljcmlyZSBsZSBjb250ZW51IGRhbnMgbGUgZmljaGllciBkZSBzb3J0aWUKICAgIHdpdGggb3BlbihmaWNoaWVyX3NvcnRpZSwgInciKSBhcyBmOgogICAgICAgIGYud3JpdGUoY29udGVudSkKCiMgVXRpbGlzYXRpb24gZGUgbGEgZm9uY3Rpb24KZmljaGllcl9lbnRyZWUgPSAiZXhlbXBsZS5weSIKZmljaGllcl9zb3J0aWUgPSAnL1VzZXJzL2FybmF1ZGNvdWJyYW4vRG9jdW1lbnRzL0NvdXJzIEIzL1Byb2pldF9kZV9maW4vU2NyaXB0X29iZnVzcXVlL2ZpY2hpZXJfb2JmdXNxdWUucHknCmFqb3V0ZXJfY29kZV9pbnV0aWxlKGZpY2hpZXJfZW50cmVlLCBmaWNoaWVyX3NvcnRpZSkKcHJpbnQoZiJMZSBmaWNoaWVyIG9iZnVzcXXpIGEg6XTpIGVucmVnaXN0cukgc291cyB7ZmljaGllcl9zb3J0aWV9IikK').decode('utf-8'))
