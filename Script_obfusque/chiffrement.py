exec(__import__('base64').b64decode('ZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKCmRlZiBnZW5lcmF0ZV9rZXkoKToKICAgICMgR+lu6XJlciB1bmUgY2zpIGV0IGxhIHJldG91cm5lcgogICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICByZXR1cm4ga2V5CgpkZWYgZW5jcnlwdF9maWxlKGZpbGVfcGF0aCwga2V5KToKICAgICMgTGlyZSBsZSBjb250ZW51IGR1IGZpY2hpZXIKICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyYicpIGFzIGZpbGU6CiAgICAgICAgZmlsZV9kYXRhID0gZmlsZS5yZWFkKCkKCiAgICAjIENy6WVyIHVuIG9iamV0IEZlcm5ldCBhdmVjIGxhIGNs6SBmb3VybmllCiAgICBjaXBoZXJfc3VpdGUgPSBGZXJuZXQoa2V5KQogICAgCiAgICAjIENoaWZmcmVyIGxlcyBkb25u6WVzCiAgICBlbmNyeXB0ZWRfZGF0YSA9IGNpcGhlcl9zdWl0ZS5lbmNyeXB0KGZpbGVfZGF0YSkKICAgIAogICAgIyBTYXV2ZWdhcmRlciBsZXMgZG9ubullcyBjaGlmZnLpZXMgZGFucyB1biBmaWNoaWVyCiAgICB3aXRoIG9wZW4oZmlsZV9wYXRoICsgJy5lbmNyeXB0ZWQnLCAnd2InKSBhcyBlbmNyeXB0ZWRfZmlsZToKICAgICAgICBlbmNyeXB0ZWRfZmlsZS53cml0ZShlbmNyeXB0ZWRfZGF0YSkKICAgIAogICAgcHJpbnQoZidGaWNoaWVyIHtmaWxlX3BhdGh9IGNoaWZmcukgZXQgc2F1dmVnYXJk6SBkYW5zIHtmaWxlX3BhdGh9LmVuY3J5cHRlZCcpCgpkZWYgZGVjcnlwdF9maWxlKGZpbGVfcGF0aCwga2V5KToKICAgICMgTGlyZSBsZXMgZG9ubullcyBjaGlmZnLpZXMgZHUgZmljaGllcgogICAgd2l0aCBvcGVuKGZpbGVfcGF0aCwgJ3JiJykgYXMgZW5jcnlwdGVkX2ZpbGU6CiAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSBlbmNyeXB0ZWRfZmlsZS5yZWFkKCkKCiAgICAjIENy6WVyIHVuIG9iamV0IEZlcm5ldCBhdmVjIGxhIGNs6SBmb3VybmllCiAgICBjaXBoZXJfc3VpdGUgPSBGZXJuZXQoa2V5KQogICAgCiAgICAjIETpY2hpZmZyZXIgbGVzIGRvbm7pZXMKICAgIGRlY3J5cHRlZF9kYXRhID0gY2lwaGVyX3N1aXRlLmRlY3J5cHQoZW5jcnlwdGVkX2RhdGEpCiAgICAKICAgICMgU2F1dmVnYXJkZXIgbGVzIGRvbm7pZXMgZOljaGlmZnLpZXMgZGFucyB1biBmaWNoaWVyCiAgICBkZWNyeXB0ZWRfZmlsZV9wYXRoID0gZmlsZV9wYXRoLnJlcGxhY2UoJy5lbmNyeXB0ZWQnLCAnJykKICAgIHdpdGggb3BlbihkZWNyeXB0ZWRfZmlsZV9wYXRoLCAnd2InKSBhcyBkZWNyeXB0ZWRfZmlsZToKICAgICAgICBkZWNyeXB0ZWRfZmlsZS53cml0ZShkZWNyeXB0ZWRfZGF0YSkKICAgIAogICAgcHJpbnQoZidGaWNoaWVyIHtkZWNyeXB0ZWRfZmlsZV9wYXRofSBk6WNoaWZmcukgZXQgc2F1dmVnYXJk6ScpCgpkZWYgbWFpbigpOgogICAgIyBH6W7pcmVyIHVuZSBjbOkKICAgIGtleSA9IGdlbmVyYXRlX2tleSgpCiAgICBwcmludChmJ0Ns6SBn6W7pcullIDoge2tleS5kZWNvZGUoKX0nKQoKICAgICMgQ2hlbWluIHZlcnMgbGUgZmljaGllciBQeXRob24g4CBjaGlmZnJlcgogICAgZmlsZV9wYXRoID0gImV4ZW1wbGUucHkiICAjIFJlbXBsYWNleiAnZXhlbXBsZS5weScgcGFyIGxlIGNoZW1pbiBkdSBmaWNoaWVyIHF1ZSB2b3VzIHNvdWhhaXRleiBjaGlmZnJlcgogICAgCiAgICAjIENoaWZmcmVyIGxlIGZpY2hpZXIKICAgIGVuY3J5cHRfZmlsZShmaWxlX3BhdGgsIGtleSkKICAgIAogICAgIyBE6WNoaWZmcmVyIGxlIGZpY2hpZXIgcG91ciB0ZXN0ZXIKICAgIGVuY3J5cHRlZF9maWxlX3BhdGggPSBmaWxlX3BhdGggKyAnLmVuY3J5cHRlZCcKICAgIGRlY3J5cHRfZmlsZShlbmNyeXB0ZWRfZmlsZV9wYXRoLCBrZXkpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgbWFpbigpCg==').decode('utf-8'))
