exec(__import__('base64').b64decode('ZGVmIHN1cHByaW1lcl9jb2RlX2ludXRpbGUoZmljaGllcl9lbnRyZWUsIGZpY2hpZXJfc29ydGllKToKICAgICMgTGlyZSBsZSBjb250ZW51IGR1IGZpY2hpZXIgZCdlbnRy6WUKICAgIHdpdGggb3BlbihmaWNoaWVyX2VudHJlZSwgInIiKSBhcyBmOgogICAgICAgIGNvbnRlbnUgPSBmLnJlYWQoKQoKICAgICMgU3VwcHJpbWVyIGxlIGNvZGUgaW51dGlsZQogICAgY29kZV9pbnV0aWxlID0gIiIiCmRlZiBmY19pbigpOgogICAgcHJpbnQoIiEhISEiKQoKZGVmIGJvdWNsZV9jb21wbGV4ZSgpOgogICAgZm9yIGkgaW4gcmFuZ2UoMTApOgogICAgICAgIGlmIGkgJSAyID09IDA6CiAgICAgICAgICAgIHByaW50KGYiTm9tYnJlIHBhaXIgOiB7aX0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYiTm9tYnJlIGltcGFpciA6IHtpfSIpCiAgICAgICAgICAgIAogICAKCmRlZiBib3VjbGVfY29tcGxleGUoKToKICAgIGZvciBpIGluIHJhbmdlKDEwKToKICAgICAgICBpZiBpICUgMiA9PSAwOgogICAgICAgICAgICBwcmludChmIk5vbWJyZSBwYWlyIDoge2l9IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChmIk5vbWJyZSBpbXBhaXIgOiB7aX0iKQoKY2xhc3MgQ2xhc3NlU2VjcmV0ZToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLnNlY3JldCA9ICIgISIKCgoKZGVmIGZpYm9uYWNjaShuKToKICAgIGlmIG4gPD0gMToKICAgICAgICByZXR1cm4gbgogICAgZWxzZToKICAgICAgICByZXR1cm4gZmlib25hY2NpKG4tMSkgKyBmaWJvbmFjY2kobi0yKQoKZGVmIHRyaV9idWxsZShsaXN0ZSk6CiAgICBuID0gbGVuKGxpc3RlKQogICAgZm9yIGkgaW4gcmFuZ2Uobik6CiAgICAgICAgZm9yIGogaW4gcmFuZ2UoMCwgbi1pLTEpOgogICAgICAgICAgICBpZiBsaXN0ZVtqXSA+IGxpc3RlW2orMV06CiAgICAgICAgICAgICAgICBsaXN0ZVtqXSwgbGlzdGVbaisxXSA9IGxpc3RlW2orMV0sIGxpc3RlW2pdCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgIyBFeGVtcGxlIGQndXRpbGlzYXRpb24KICAgIG1hX2xpc3RlID0gWzUsIDIsIDgsIDEsIDNdCiAgICB0cmlfYnVsbGUobWFfbGlzdGUpCgoKY2xhc3MgQ2xhc3NlU2VjcmV0ZToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLnNlY3JldCA9ICIhISEiCgogICAgZGVmIGFmZmljaGVyX3NlY3JldChzZWxmKToKICAgICAgICBwcmludChzZWxmLnNlY3JldCkKCmRlZiBmaWJvbmFjY2kobik6CiAgICBpZiBuIDw9IDE6CiAgICAgICAgcmV0dXJuIG4KICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIGZpYm9uYWNjaShuLTEpICsgZmlib25hY2NpKG4tMikKIiIiCgogICAgY29udGVudSA9IGNvbnRlbnUucmVwbGFjZShjb2RlX2ludXRpbGUsICIiKQoKICAgICMgyWNyaXJlIGxlIGNvbnRlbnUgc2FucyBsZSBjb2RlIGludXRpbGUgZGFucyBsZSBmaWNoaWVyIGRlIHNvcnRpZQogICAgd2l0aCBvcGVuKGZpY2hpZXJfc29ydGllLCAidyIpIGFzIGY6CiAgICAgICAgZi53cml0ZShjb250ZW51KQoKIyBVdGlsaXNhdGlvbiBkZSBsYSBmb25jdGlvbgpmaWNoaWVyX2VudHJlZSA9ICcvVXNlcnMvYXJuYXVkY291YnJhbi9Eb2N1bWVudHMvQ291cnMgQjMvUHJvamV0X2RlX2Zpbi9TY3JpcHRfb2JmdXNxdWUvZmljaGllcl9vYmZ1c3F1ZS5weScKZmljaGllcl9zb3J0aWUgPSAnL1VzZXJzL2FybmF1ZGNvdWJyYW4vRG9jdW1lbnRzL0NvdXJzIEIzL1Byb2pldF9kZV9maW4vU2NyaXB0X2Rlc29iZnVzcXVlL2ZpY2hpZXJfZGVzb2JmdXNxdWUucHknCnN1cHByaW1lcl9jb2RlX2ludXRpbGUoZmljaGllcl9lbnRyZWUsIGZpY2hpZXJfc29ydGllKQpwcmludChmIkxlIGZpY2hpZXIgbmV0dG956SBhIOl06SBlbnJlZ2lzdHLpIHNvdXMge2ZpY2hpZXJfc29ydGllfSIpCg==').decode('utf-8'))
